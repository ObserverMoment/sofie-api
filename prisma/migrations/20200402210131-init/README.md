# Migration `20200402210131-init`

This migration has been generated by ObserverMoment at 4/2/2020, 9:01:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Benchmark" (
    "completedOn" timestamp(3)  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "level" "Level" NOT NULL ,
    "notes" text   ,
    "score" integer  NOT NULL ,
    "userId" text  NOT NULL ,
    "workoutId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."League" (
    "description" text   ,
    "id" text  NOT NULL ,
    "logoUrl" text   ,
    "name" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Move" (
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."User" (
    "age" integer  NOT NULL ,
    "avatarUrl" text   ,
    "bio" text   ,
    "country" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "displayName" text  NOT NULL ,
    "email" text  NOT NULL ,
    "firstname" text  NOT NULL ,
    "gender" "Gender" NOT NULL ,
    "gymBox" text   ,
    "height" integer  NOT NULL ,
    "id" text  NOT NULL ,
    "lastname" text  NOT NULL ,
    "passwordHash" text  NOT NULL ,
    "townCity" text   ,
    "weight" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Workout" (
    "description" text   ,
    "id" text  NOT NULL ,
    "name" text  NOT NULL ,
    "summary" text  NOT NULL ,
    "workoutType" "WorkoutType" NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."WorkoutMove" (
    "beginnerScaling" text   ,
    "id" text  NOT NULL ,
    "intermediateScaling" text   ,
    "moveId" text  NOT NULL ,
    "prescribedScaling" text  NOT NULL ,
    "workoutId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."WorkoutVideo" (
    "benchmarkId" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "notes" text   ,
    "videoUrl" text  NOT NULL ,
    "workoutId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."WorldRecord" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "recordType" "RecordType" NOT NULL ,
    "recordValue" integer  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    "workoutId" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."_LeagueToUser" (
    "A" text  NOT NULL ,
    "B" text  NOT NULL 
) 

CREATE UNIQUE INDEX "League.name" ON "public"."League"("name")

CREATE UNIQUE INDEX "Move.name" ON "public"."Move"("name")

CREATE UNIQUE INDEX "User.displayName" ON "public"."User"("displayName")

CREATE UNIQUE INDEX "Workout.name" ON "public"."Workout"("name")

CREATE UNIQUE INDEX "WorkoutVideo_benchmarkId" ON "public"."WorkoutVideo"("benchmarkId")

CREATE UNIQUE INDEX "WorldRecord_workoutId" ON "public"."WorldRecord"("workoutId")

CREATE UNIQUE INDEX "_LeagueToUser_AB_unique" ON "public"."_LeagueToUser"("A","B")

CREATE  INDEX "_LeagueToUser_B_index" ON "public"."_LeagueToUser"("B")

ALTER TABLE "public"."Benchmark" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Benchmark" ADD FOREIGN KEY ("workoutId")REFERENCES "public"."Workout"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."WorkoutMove" ADD FOREIGN KEY ("moveId")REFERENCES "public"."Move"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."WorkoutMove" ADD FOREIGN KEY ("workoutId")REFERENCES "public"."Workout"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."WorkoutVideo" ADD FOREIGN KEY ("workoutId")REFERENCES "public"."Workout"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."WorkoutVideo" ADD FOREIGN KEY ("benchmarkId")REFERENCES "public"."Benchmark"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."WorldRecord" ADD FOREIGN KEY ("workoutId")REFERENCES "public"."Workout"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_LeagueToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."League"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_LeagueToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200402210131-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,131 @@
+// https://github.com/prisma/prisma2
+// SDL first example: https://github.com/prisma/prisma-examples/tree/prisma2/javascript/graphql-sdl-first
+// Migrations: https://github.com/prisma/migrate
+generator client {
+  provider = "prisma-client-js"
+}
+
+// url      = env("DATABASE_URL")
+datasource db {
+  provider = "postgresql"
+  url      = "postgres://vksegplfohzkfb:4006286c49b2ccada42a32cc56f0405ae370152bd9e594d3f38b5d1f34cebadb@ec2-79-125-26-232.eu-west-1.compute.amazonaws.com:5432/dfj0e91erhbqs1"
+}
+
+model Benchmark {
+  id           String        @default(uuid()) @id
+  createdAt    DateTime      @default(now())
+  completedOn  DateTime
+  level        Level
+  score        Int
+  notes        String?
+  user         User          @relation(fields: [userId], references: [id])
+  userId       String
+  workout      Workout       @relation(fields: [workoutId], references: [id])
+  workoutId    String
+  workoutVideo WorkoutVideo?
+}
+
+model League {
+  id          String  @default(uuid()) @id
+  logoUrl     String?
+  name        String  @unique
+  description String?
+  user        User[]  @relation(references: [id])
+}
+
+model Move {
+  id           String        @default(uuid()) @id
+  name         String        @unique
+  workoutMoves WorkoutMove[]
+}
+
+model User {
+  id           String      @default(uuid()) @id
+  createdAt    DateTime    @default(now())
+  avatarUrl    String?
+  displayName  String      @unique
+  firstname    String
+  lastname     String
+  email        String
+  passwordHash String
+  bio          String?
+  age          Int
+  gender       Gender
+  height       Int
+  weight       Int
+  gymBox       String?
+  townCity     String?
+  country      String?
+  benchmarks   Benchmark[]
+  leagues      League[]    @relation(references: [id])
+}
+
+model Workout {
+  id            String         @default(uuid()) @id
+  name          String         @unique
+  summary       String
+  description   String?
+  workoutType   WorkoutType
+  workoutMoves  WorkoutMove[]
+  workoutVideos WorkoutVideo[]
+  worldRecord   WorldRecord?
+  benchmarks    Benchmark[]
+}
+
+model WorkoutMove {
+  id                  String  @default(uuid()) @id
+  beginnerScaling     String?
+  intermediateScaling String?
+  prescribedScaling   String
+  move                Move    @relation(fields: [moveId], references: [id])
+  moveId              String
+  workout             Workout @relation(fields: [workoutId], references: [id])
+  workoutId           String
+}
+
+model WorkoutVideo {
+  id          String    @default(uuid()) @id
+  createdAt   DateTime  @default(now())
+  videoUrl    String
+  notes       String?
+  workout     Workout   @relation(fields: [workoutId], references: [id])
+  workoutId   String
+  benchmark   Benchmark @relation(fields: [benchmarkId], references: [id])
+  benchmarkId String
+}
+
+model WorldRecord {
+  id          String     @default(uuid()) @id
+  createdAt   DateTime   @default(now())
+  updatedAt   DateTime   @updatedAt
+  recordValue Int
+  recordType  RecordType
+  workout     Workout    @relation(fields: [workoutId], references: [id])
+  workoutId   String
+}
+
+enum Gender {
+  MALE
+  FEMALE
+}
+
+enum Level {
+  BEGINNER
+  INTERMEDIATE
+  ELITE
+}
+
+// AMRAP in reps
+// TIME in seconds
+// LOAD in lbs
+enum RecordType {
+  AMRAP
+  TIME
+  LOAD
+}
+
+enum WorkoutType {
+  AMRAP
+  FORTIME
+  FORLOAD
+}
```



# Migration `20201002123840-move-profile-2`

This migration has been generated by ObserverMoment at 10/2/2020, 1:38:40 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."_compoundMoves" DROP CONSTRAINT "_compoundMoves_A_fkey"

ALTER TABLE "public"."_compoundMoves" DROP CONSTRAINT "_compoundMoves_B_fkey"

ALTER TABLE "public"."Equipment" ADD COLUMN "gymProfileId" text   

ALTER TABLE "public"."Move" DROP COLUMN "moveType"

DROP TYPE "MoveType"

CREATE TABLE "public"."MoveProfile" (
"id" text   NOT NULL ,
"userId" text   NOT NULL ,
"name" text   NOT NULL ,
"description" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_requiredMoves" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_excludedMoves" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE UNIQUE INDEX "_requiredMoves_AB_unique" ON "public"."_requiredMoves"("A", "B")

CREATE INDEX "_requiredMoves_B_index" ON "public"."_requiredMoves"("B")

CREATE UNIQUE INDEX "_excludedMoves_AB_unique" ON "public"."_excludedMoves"("A", "B")

CREATE INDEX "_excludedMoves_B_index" ON "public"."_excludedMoves"("B")

ALTER TABLE "public"."MoveProfile" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_requiredMoves" ADD FOREIGN KEY ("A")REFERENCES "public"."Move"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_requiredMoves" ADD FOREIGN KEY ("B")REFERENCES "public"."MoveProfile"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_excludedMoves" ADD FOREIGN KEY ("A")REFERENCES "public"."Move"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_excludedMoves" ADD FOREIGN KEY ("B")REFERENCES "public"."MoveProfile"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Equipment" ADD FOREIGN KEY ("gymProfileId")REFERENCES "public"."GymProfile"("id") ON DELETE SET NULL ON UPDATE CASCADE

DROP TABLE "public"."_compoundMoves"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201002123621-move-profile..20201002123840-move-profile-2
--- datamodel.dml
+++ datamodel.dml
@@ -6,9 +6,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 // model ScoreSubmission {
 //   id                     String                @default(uuid()) @id
@@ -342,9 +342,9 @@
   scheduledWorkouts ScheduledWorkout[]
   loggedWorkouts    LoggedWorkout[]
   likedWorkouts     LikedWorkout[]
   gymProfiles       GymProfile[]
-  MoveProfile       MoveProfile[]
+  moveProfiles      MoveProfile[]
 }
 // Enums
 enum AccessScopeType {
```



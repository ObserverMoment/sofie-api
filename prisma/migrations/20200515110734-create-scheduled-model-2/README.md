# Migration `20200515110734-create-scheduled-model-2`

This migration has been generated by ObserverMoment at 5/15/2020, 11:07:34 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."ScheduledWorkout" (
"completed" boolean  NOT NULL DEFAULT false,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"createdById" text  NOT NULL ,"id" text  NOT NULL ,"scheduledAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"workoutId" text  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Challenge" ALTER COLUMN "scope" SET DEFAULT 'PRIVATE';

ALTER TABLE "public"."Group" ALTER COLUMN "scope" SET DEFAULT 'PRIVATE';

ALTER TABLE "public"."Move" ADD COLUMN "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "createdById" text   ,
ALTER COLUMN "scope" SET DEFAULT 'PRIVATE';

ALTER TABLE "public"."User" ALTER COLUMN "unitSystem" SET DEFAULT 'METRIC';

ALTER TABLE "public"."Workout" ADD COLUMN "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "createdById" text   ,
ALTER COLUMN "scope" SET DEFAULT 'PRIVATE';

ALTER TABLE "public"."WorkoutMove" ADD COLUMN "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "createdById" text   ;

ALTER TABLE "public"."ScheduledWorkout" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."ScheduledWorkout" ADD FOREIGN KEY ("workoutId")REFERENCES "public"."Workout"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Move" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Workout" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."WorkoutMove" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200515110545-create-scheduled-model..20200515110734-create-scheduled-model-2
--- datamodel.dml
+++ datamodel.dml
@@ -4,12 +4,12 @@
 generator client {
   provider = "prisma-client-js"
 }
-// url = "***"
+// url      = env("DATABASE_URL")
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgres://vksegplfohzkfb:4006286c49b2ccada42a32cc56f0405ae370152bd9e594d3f38b5d1f34cebadb@ec2-79-125-26-232.eu-west-1.compute.amazonaws.com:5432/dfj0e91erhbqs1"
 }
 model Benchmark {
   id               String          @default(uuid()) @id
@@ -126,22 +126,22 @@
   workoutId           String
 }
 model Workout {
-  id               String             @default(uuid()) @id
-  createdAt        DateTime           @default(now())
-  createdBy        User?              @relation(fields: [createdById], references: [id])
-  createdById      String?
-  name             String             @unique
-  category         WodCategory
-  scope            AccessScopeType    @default(PRIVATE)
-  summary          String?
-  description      String?
-  workoutType      WorkoutType
-  workoutMoves     WorkoutMove[]
-  worldRecords     WorldRecord[]
-  challenges       Challenge[]        @relation(references: [id])
-  ScheduledWorkout ScheduledWorkout[]
+  id                String             @default(uuid()) @id
+  createdAt         DateTime           @default(now())
+  createdBy         User?              @relation(fields: [createdById], references: [id])
+  createdById       String?
+  name              String             @unique
+  category          WodCategory
+  scope             AccessScopeType    @default(PRIVATE)
+  summary           String?
+  description       String?
+  workoutType       WorkoutType
+  workoutMoves      WorkoutMove[]
+  worldRecords      WorldRecord[]
+  challenges        Challenge[]        @relation(references: [id])
+  scheduledWorkouts ScheduledWorkout[]
 }
 model ScheduledWorkout {
   id          String   @default(uuid()) @id
@@ -198,12 +198,12 @@
   following                    UserConnection[]               @relation("follower")
   groupsWhereAdmin             Group[]                        @relation("group_admin")
   groupsWhereMember            Group[]                        @relation("group_member")
   groupsWhereCreator           Group[]                        @relation("group_creator")
-  Move                         Move[]
-  WorkoutMove                  WorkoutMove[]
-  Workout                      Workout[]
-  ScheduledWorkout             ScheduledWorkout[]
+  moves                        Move[]
+  workoutMoves                 WorkoutMove[]
+  workouts                     Workout[]
+  scheduledWorkouts            ScheduledWorkout[]
 }
 // Need to check if the below names are the correct way around
 // What actually happens (what query is made) when you run User.followers with @relation("followee")?
```



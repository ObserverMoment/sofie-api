# Migration `20200601144218-standardise-relationship-naming`

This migration has been generated by ObserverMoment at 6/1/2020, 2:42:18 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_groupToAdmins" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_groupToMembers" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_moveToRequiredEquipments" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_moveToSelectableEquipments" (
"A" text  NOT NULL ,"B" text  NOT NULL )

ALTER TABLE "public"."Challenge" ALTER COLUMN "scope" SET DEFAULT E'PRIVATE';

ALTER TABLE "public"."Group" ALTER COLUMN "scope" SET DEFAULT E'PRIVATE';

ALTER TABLE "public"."Move" ALTER COLUMN "scope" SET DEFAULT E'PRIVATE';

ALTER TABLE "public"."User" ALTER COLUMN "subscriptionLevel" SET DEFAULT E'FREE',
ALTER COLUMN "unitSystem" SET DEFAULT E'METRIC';

ALTER TABLE "public"."Workout" ALTER COLUMN "difficultyLevel" SET DEFAULT E'ONE',
ALTER COLUMN "scope" SET DEFAULT E'PRIVATE',
ALTER COLUMN "workoutScoreType" SET DEFAULT E'AMREPS';

ALTER TABLE "public"."WorkoutMove" ALTER COLUMN "repType" SET DEFAULT E'REPS';

ALTER TABLE "public"."WorldRecord" ALTER COLUMN "workoutScoreType" SET DEFAULT E'AMREPS';

ALTER TABLE "public"."_group_admin" DROP CONSTRAINT IF EXiSTS "_group_admin_A_fkey";

ALTER TABLE "public"."_group_admin" DROP CONSTRAINT IF EXiSTS "_group_admin_B_fkey";

ALTER TABLE "public"."_group_member" DROP CONSTRAINT IF EXiSTS "_group_member_A_fkey";

ALTER TABLE "public"."_group_member" DROP CONSTRAINT IF EXiSTS "_group_member_B_fkey";

ALTER TABLE "public"."_required_equipments" DROP CONSTRAINT IF EXiSTS "_required_equipments_A_fkey";

ALTER TABLE "public"."_required_equipments" DROP CONSTRAINT IF EXiSTS "_required_equipments_B_fkey";

ALTER TABLE "public"."_selectable_equipments" DROP CONSTRAINT IF EXiSTS "_selectable_equipments_A_fkey";

ALTER TABLE "public"."_selectable_equipments" DROP CONSTRAINT IF EXiSTS "_selectable_equipments_B_fkey";

CREATE UNIQUE INDEX "_groupToAdmins_AB_unique" ON "public"."_groupToAdmins"("A","B")

CREATE  INDEX "_groupToAdmins_B_index" ON "public"."_groupToAdmins"("B")

CREATE UNIQUE INDEX "_groupToMembers_AB_unique" ON "public"."_groupToMembers"("A","B")

CREATE  INDEX "_groupToMembers_B_index" ON "public"."_groupToMembers"("B")

CREATE UNIQUE INDEX "_moveToRequiredEquipments_AB_unique" ON "public"."_moveToRequiredEquipments"("A","B")

CREATE  INDEX "_moveToRequiredEquipments_B_index" ON "public"."_moveToRequiredEquipments"("B")

CREATE UNIQUE INDEX "_moveToSelectableEquipments_AB_unique" ON "public"."_moveToSelectableEquipments"("A","B")

CREATE  INDEX "_moveToSelectableEquipments_B_index" ON "public"."_moveToSelectableEquipments"("B")

ALTER TABLE "public"."_groupToAdmins" ADD FOREIGN KEY ("A")REFERENCES "public"."Group"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_groupToAdmins" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_groupToMembers" ADD FOREIGN KEY ("A")REFERENCES "public"."Group"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_groupToMembers" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_moveToRequiredEquipments" ADD FOREIGN KEY ("A")REFERENCES "public"."Equipment"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_moveToRequiredEquipments" ADD FOREIGN KEY ("B")REFERENCES "public"."Move"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_moveToSelectableEquipments" ADD FOREIGN KEY ("A")REFERENCES "public"."Equipment"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_moveToSelectableEquipments" ADD FOREIGN KEY ("B")REFERENCES "public"."Move"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."_group_admin";

DROP TABLE "public"."_group_member";

DROP TABLE "public"."_required_equipments";

DROP TABLE "public"."_selectable_equipments";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200601143628-move-selectable-optional-equipments-2..20200601144218-standardise-relationship-naming
--- datamodel.dml
+++ datamodel.dml
@@ -6,9 +6,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model Benchmark {
   id               String          @default(uuid()) @id
@@ -91,21 +91,21 @@
   logoUrl     String?
   name        String          @unique
   countryCode String?
   description String?
-  createdBy   User            @relation("group_creator", fields: [createdById], references: [id])
+  createdBy   User            @relation("groupToCreator", fields: [createdById], references: [id])
   createdById String
-  admins      User[]          @relation("group_admin", references: [id])
-  members     User[]          @relation("group_member", references: [id])
+  admins      User[]          @relation("groupToAdmins", references: [id])
+  members     User[]          @relation("groupToMembers", references: [id])
   challenges  Challenge[]
 }
 model Equipment {
   id                 String        @default(uuid()) @id
   name               String        @unique
   imageUrl           String?
-  requiredForMoves   Move[]        @relation("required_equipments", references: [id])
-  selectableForMoves Move[]        @relation("selectable_equipments", references: [id])
+  requiredForMoves   Move[]        @relation("moveToRequiredEquipments", references: [id])
+  selectableForMoves Move[]        @relation("moveToSelectableEquipments", references: [id])
   WorkoutMove        WorkoutMove[]
 }
 model Move {
@@ -116,10 +116,10 @@
   scope                AccessScopeType @default(PRIVATE)
   name                 String          @unique
   description          String?
   demoVideoUrl         String?
-  requiredEquipments   Equipment[]     @relation("required_equipments", references: [id])
-  selectableEquipments Equipment[]     @relation("selectable_equipments", references: [id])
+  requiredEquipments   Equipment[]     @relation("moveToRequiredEquipments", references: [id])
+  selectableEquipments Equipment[]     @relation("moveToSelectableEquipments", references: [id])
   workoutMoves         WorkoutMove[]
   moveVariations       MoveVariation[]
 }
@@ -252,11 +252,11 @@
   BenchmarkVideoCommentReplies BenchmarkVideoCommentReplies[]
   watchedChallenges            Challenge[]                    @relation("watchersToChallenges", references: [id])
   followers                    UserConnection[]               @relation("followee")
   following                    UserConnection[]               @relation("follower")
-  groupsWhereAdmin             Group[]                        @relation("group_admin")
-  groupsWhereMember            Group[]                        @relation("group_member")
-  groupsWhereCreator           Group[]                        @relation("group_creator")
+  groupsWhereAdmin             Group[]                        @relation("groupToAdmins")
+  groupsWhereMember            Group[]                        @relation("groupToMembers")
+  groupsWhereCreator           Group[]                        @relation("groupToCreator")
   moves                        Move[]
   workouts                     Workout[]
   scheduledWorkouts            ScheduledWorkout[]
 }
```



# Migration `20201002144108-gym-profile-available-equipments`

This migration has been generated by ObserverMoment at 10/2/2020, 3:41:08 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Equipment" DROP CONSTRAINT "Equipment_gymProfileId_fkey"

ALTER TABLE "public"."Equipment" DROP COLUMN "gymProfileId"

CREATE TABLE "public"."_EquipmentToGymProfile" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE UNIQUE INDEX "_EquipmentToGymProfile_AB_unique" ON "public"."_EquipmentToGymProfile"("A", "B")

CREATE INDEX "_EquipmentToGymProfile_B_index" ON "public"."_EquipmentToGymProfile"("B")

ALTER TABLE "public"."_EquipmentToGymProfile" ADD FOREIGN KEY ("A")REFERENCES "public"."Equipment"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_EquipmentToGymProfile" ADD FOREIGN KEY ("B")REFERENCES "public"."GymProfile"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201002123840-move-profile-2..20201002144108-gym-profile-available-equipments
--- datamodel.dml
+++ datamodel.dml
@@ -6,9 +6,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 // model ScoreSubmission {
 //   id                     String                @default(uuid()) @id
@@ -108,10 +108,9 @@
   imageUrl           String?
   requiredForMoves   Move[]        @relation("moveToRequiredEquipments", references: [id])
   selectableForMoves Move[]        @relation("moveToSelectableEquipments", references: [id])
   WorkoutMove        WorkoutMove[]
-  GymProfile         GymProfile?   @relation(fields: [gymProfileId], references: [id])
-  gymProfileId       String?
+  gymProfiles        GymProfile[]
 }
 model Move {
   id                   String               @id @default(uuid())
```



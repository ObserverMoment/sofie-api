# Migration `20200601143628-move-selectable-optional-equipments-2`

This migration has been generated by ObserverMoment at 6/1/2020, 2:36:28 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."_required_equipments" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_selectable_equipments" (
"A" text  NOT NULL ,"B" text  NOT NULL )

ALTER TABLE "public"."Challenge" ALTER COLUMN "scope" SET DEFAULT E'PRIVATE';

ALTER TABLE "public"."Group" ALTER COLUMN "scope" SET DEFAULT E'PRIVATE';

ALTER TABLE "public"."Move" ALTER COLUMN "scope" SET DEFAULT E'PRIVATE';

ALTER TABLE "public"."User" ALTER COLUMN "subscriptionLevel" SET DEFAULT E'FREE',
ALTER COLUMN "unitSystem" SET DEFAULT E'METRIC';

ALTER TABLE "public"."Workout" ALTER COLUMN "difficultyLevel" SET DEFAULT E'ONE',
ALTER COLUMN "scope" SET DEFAULT E'PRIVATE',
ALTER COLUMN "workoutScoreType" SET DEFAULT E'AMREPS';

ALTER TABLE "public"."WorkoutMove" ALTER COLUMN "repType" SET DEFAULT E'REPS';

ALTER TABLE "public"."WorldRecord" ALTER COLUMN "workoutScoreType" SET DEFAULT E'AMREPS';

ALTER TABLE "public"."_EquipmentToMove" DROP CONSTRAINT IF EXiSTS "_EquipmentToMove_A_fkey";

ALTER TABLE "public"."_EquipmentToMove" DROP CONSTRAINT IF EXiSTS "_EquipmentToMove_B_fkey";

CREATE UNIQUE INDEX "_required_equipments_AB_unique" ON "public"."_required_equipments"("A","B")

CREATE  INDEX "_required_equipments_B_index" ON "public"."_required_equipments"("B")

CREATE UNIQUE INDEX "_selectable_equipments_AB_unique" ON "public"."_selectable_equipments"("A","B")

CREATE  INDEX "_selectable_equipments_B_index" ON "public"."_selectable_equipments"("B")

ALTER TABLE "public"."_required_equipments" ADD FOREIGN KEY ("A")REFERENCES "public"."Equipment"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_required_equipments" ADD FOREIGN KEY ("B")REFERENCES "public"."Move"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_selectable_equipments" ADD FOREIGN KEY ("A")REFERENCES "public"."Equipment"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_selectable_equipments" ADD FOREIGN KEY ("B")REFERENCES "public"."Move"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."_EquipmentToMove";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200601143539-move-selectable-optional-equipments..20200601143628-move-selectable-optional-equipments-2
--- datamodel.dml
+++ datamodel.dml
@@ -6,9 +6,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model Benchmark {
   id               String          @default(uuid()) @id
@@ -99,14 +99,14 @@
   challenges  Challenge[]
 }
 model Equipment {
-  id               String        @default(uuid()) @id
-  name             String        @unique
-  imageUrl         String?
-  requiredForMoves Move[]        @relation("required_equipments", references: [id])
-  optionalForMoves Move[]        @relation("selectable_equipments", references: [id])
-  WorkoutMove      WorkoutMove[]
+  id                 String        @default(uuid()) @id
+  name               String        @unique
+  imageUrl           String?
+  requiredForMoves   Move[]        @relation("required_equipments", references: [id])
+  selectableForMoves Move[]        @relation("selectable_equipments", references: [id])
+  WorkoutMove        WorkoutMove[]
 }
 model Move {
   id                   String          @default(uuid()) @id
```



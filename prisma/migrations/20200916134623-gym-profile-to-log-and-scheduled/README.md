# Migration `20200916134623-gym-profile-to-log-and-scheduled`

This migration has been generated by ObserverMoment at 9/16/2020, 2:46:23 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."LoggedWorkout" ADD COLUMN "gymProfileId" text   

ALTER TABLE "public"."ScheduledWorkout" ADD COLUMN "gymProfileId" text   

ALTER TABLE "public"."LoggedWorkout" ADD FOREIGN KEY ("gymProfileId")REFERENCES "public"."GymProfile"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."ScheduledWorkout" ADD FOREIGN KEY ("gymProfileId")REFERENCES "public"."GymProfile"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200916112611-workout-location-to-gym-profile..20200916134623-gym-profile-to-log-and-scheduled
--- datamodel.dml
+++ datamodel.dml
@@ -6,9 +6,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 // model ScoreSubmission {
 //   id                     String                @default(uuid()) @id
@@ -147,14 +147,16 @@
 //   workouts    Workout[]
 // }
 model GymProfile {
-  id          String  @default(uuid()) @id
-  user        User    @relation(fields: [userId], references: [id])
-  userId      String
-  name        String
-  description String?
-  postcode    String?
+  id                String             @default(uuid()) @id
+  user              User               @relation(fields: [userId], references: [id])
+  userId            String
+  name              String
+  description       String?
+  postcode          String?
+  scheduledWorkouts ScheduledWorkout[]
+  loggedWorkouts    LoggedWorkout[]
 }
 model Workout {
   id                String             @default(uuid()) @id
@@ -194,8 +196,10 @@
   workout         Workout        @relation(fields: [workoutId], references: [id])
   workoutId       String
   loggedWorkout   LoggedWorkout? @relation(fields: [loggedWorkoutId], references: [id])
   loggedWorkoutId String?
+  gymProfile      GymProfile?    @relation(fields: [gymProfileId], references: [id])
+  gymProfileId    String?
 }
 // Users can apply these to any workout they want, whereas WorkoutTags can only
 // be applied to workouts that you create / own.
@@ -307,8 +311,10 @@
   originalWorkoutId    String?
   originalWorkoutScope AccessScopeType
   scheduledWorkout     ScheduledWorkout?
   scheduledWorkoutId   String?
+  gymProfile           GymProfile?       @relation(fields: [gymProfileId], references: [id])
+  gymProfileId         String?
 }
 // Height in cms / weight in kgs
 model User {
```


